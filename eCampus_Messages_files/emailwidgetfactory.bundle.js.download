define("pets-client-email/2.4.0/public/javascript/emailapi", ["pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/externalevent"],function(a,b){function c(c){return a.trace("Pets-Email::EmailApi::subscribeRefresh"),b.subscribe(A.Refresh,c)}function d(c){a.trace("Pets-Email::EmailApi::postRefresh"),c||(c=!1),b.publish(A.Refresh,{setWorkingStatusFocus:c})}function e(c){return a.trace("Pets-Email::EmailApi::subscribeFromCache"),b.subscribe(A.FromCache,c)}function f(){a.trace("Pets-Email::EmailApi::postFromCache"),b.publish(A.FromCache)}function g(c){return a.trace("Pets-Email::EmailApi::subscribePollingControl"),b.subscribe(A.PollingControl,c)}function h(c){a.trace("Pets-Email::EmailApi::postPollingControl"),b.publish(A.PollingControl,{pollingOn:c})}function i(c){return a.trace("Pets-Email::EmailApi::subscribeMessages"),b.subscribe(A.Messages,c)}function j(c){a.trace("Pets-Email::EmailApi::postMessages"),b.publish(A.Messages,c)}function k(c){return a.trace("Pets-Email::EmailApi::subscribeWorking"),b.subscribe(A.Working,c)}function l(c,d){a.trace("Pets-Email::EmailApi::postWorking"),d||(d=!1),b.publish(A.Working,{isWorking:c,setFocus:d})}function m(c){return a.trace("Pets-Email::EmailApi::subscribeError"),b.subscribe(A.Error,c)}function n(c,d){a.trace("Pets-Email::EmailApi::postError"),b.publish(A.Error,{code:c,message:d})}function o(c){return a.trace("Pets-Email::EmailApi::subscribeClickEvent"),b.subscribe(A.ClickAction,c)}function p(c,d){a.trace("Pets-Email::EmailApi::postClickEvent"),b.publish(A.ClickAction,{action:c,index:d})}function q(c){return a.trace("Pets-Email::EmailApi::subscribePreferences"),b.subscribe(A.Preferences,c)}function r(c){a.trace("Pets-Email::EmailApi::postPreferences"),b.publish(A.Preferences,c)}function s(c){return a.trace("Pets-Email::EmailApi::subscribeUpdatePreferences"),b.subscribe(A.UpdatePreferences,c)}function t(c){a.trace("Pets-Email::EmailApi::postUpdatePreferences"),b.publish(A.UpdatePreferences,c)}function u(c){return a.trace("Pets-Email::EmailApi::subscribePreferencesControl"),b.subscribe(A.LoadPreferences,c)}function v(c){a.trace("Pets-Email::EmailApi::postLoadPreferences"),b.publish(A.LoadPreferences,{preferencesOn:c})}function w(c){return a.trace("Pets-Email::EmailApi::subscribeUnreadMessageCount"),b.subscribe(A.LoadUnreadMessageCount,c)}function x(){a.trace("Pets-Email::EmailApi::postLoadUnreadMessageCount"),b.publish(A.LoadUnreadMessageCount)}function y(c){return a.trace("Pets-Email::EmailApi::subscribeUpdateUnreadMessageCount"),b.subscribe(A.UpdateUnreadMessageCount,c)}function z(c){a.trace("Pets-Email::EmailApi::postUpdateUnreadMessageCount"),b.publish(A.UpdateUnreadMessageCount,c)}a.trace("Pets-Email::EmailApi::ctor");var A={Refresh:"edu.apollogrp.pets.email.refresh",FromCache:"edu.apollogrp.pets.email.fromcache",PollingControl:"edu.apollogrp.pets.email.pollingcontrol",Messages:"edu.apollogrp.pets.email.messages",Working:"edu.apollogrp.pets.email.working",Error:"edu.apollogrp.pets.email.error",ClickAction:"edu.apollogrp.pets.email.clickaction",Preferences:"edu.apollogrp.pets.email.preferences",UpdatePreferences:"edu.apollogrp.pets.email.updatepreferences",LoadPreferences:"edu.apollogrp.pets.email.loadpreferences",LoadUnreadMessageCount:"edu.apollogrp.pets.email.loadunreadmessagecount",UpdateUnreadMessageCount:"edu.apollogrp.pets.email.updateunreadmessagecount"};return{subscribeRefresh:c,postRefresh:d,subscribeFromCache:e,postFromCache:f,subscribeMessages:i,postMessages:j,subscribeWorking:k,postWorking:l,subscribeError:m,postError:n,subscribePollingControl:g,postPollingControl:h,subscribeClickEvent:o,postClickEvent:p,subscribePreferences:q,postPreferences:r,subscribeUpdatePreferences:s,postUpdatePreferences:t,subscribeLoadPreferences:u,postLoadPreferences:v,subscribeLoadUnreadMessageCount:w,postLoadUnreadMessageCount:x,subscribeUpdateUnreadMessageCount:y,postUpdateUnreadMessageCount:z}});

define("pets-client-email/2.4.0/public/javascript/emailcache", ["pets-client-core/2.6.0/public/javascript/petsconfig","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/cacheproxy"],function(a,b,c,d){function e(a){b.trace("Pets-Email::emailCache::setFolderSummary: ","save email data in cache"),d.getCache(o.FolderSummary,p).set(a)}function f(a){b.trace("Pets-Email::emailCache::setUpdatedTime: ","save updatedtime in cache"+a),d.getCache(o.UpdatedTime,p).set(a)}function g(a){b.trace("Pets-Email::emailCache::setUnreadMessageCount"),d.getCache(o.UnreadMessageCount,p).set(a)}function h(a){b.trace("Pets-Email::emailCache::setUserEmailAddress"),d.getCache(o.UserEmailAddress,p).set(a)}function i(a){b.trace("Pets-Email::emailCache::setPreferences"),d.getCache(o.Preferences,p).set(a)}function j(a){b.trace("Pets-Email::emailCache::getFolderSummary"),d.getCache(o.FolderSummary,p).snapshot(a)}function k(a){b.trace("Pets-Email::emailCache::getUpdatedTime"),d.getCache(o.UpdatedTime,p).snapshot(a)}function l(a){b.trace("Pets-Email::emailCache::getUnreadMessageCount"),d.getCache(o.UnreadMessageCount,p).snapshot(a)}function m(a){b.trace("Pets-Email::emailCache::getUserEmailAddress"),d.getCache(o.UserEmailAddress,p).snapshot(a)}function n(a){b.trace("Pets-Email::emailCache::getPreferences"),d.getCache(o.Preferences,p).snapshot(a)}b.trace("Pets-Email::EmailCache::ctor");var o={FolderSummary:"emailcache.foldersummary",UpdatedTime:"emailcache.cachedupdatedtime",UnreadMessageCount:"emailcache.unreadmessagecount",UserEmailAddress:"emailcache.useremailaddress",Preferences:"emailcache.preferences"},p={area:"localStorage",durationHours:24};return{setFolderSummary:e,setUpdatedTime:f,getFolderSummary:j,getUpdatedTime:k,setUnreadMessageCount:g,getUnreadMessageCount:l,setUserEmailAddress:h,getUserEmailAddress:m,setPreferences:i,getPreferences:n}});

define("pets-client-email/2.4.0/public/javascript/emailconfig", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/petsconfig!pets-client-email/2.4.0/public/config/email"],function(a,b,c,d){c.trace("PETS-Client-Email::EmailConfig::ctor");var e={EmailServiceURI:{INBOX:location.protocol+"//"+location.hostname+":"+location.port+"/api/petsemail/pets/email/folderSummary.json",KEY:location.protocol+"//"+location.hostname+":"+location.port+"/api/petsemail/pets/email/getKey.json",LOG_DATA:location.protocol+"//"+location.hostname+":"+location.port+"/api/petsemail/instrumentation/log.json"},preferencesURI:{GET_PREF:location.protocol+"//"+location.hostname+":"+location.port+"/api/core/users/current/getpreference/edu.apollogrp.pets.email.preferences/.json",SET_PREF:location.protocol+"//"+location.hostname+":"+location.port+"/api/core/users/current/setpreference.json"},pollingInterval:9e5,minutePollingInterval:6e4,refreshInterval:870,noRefreshInterval:0,numEmailMessages:20,noCacheActionType:"NO_CACHE",cacheOnlyActionType:"CACHE_ONLY",inboxUrl:" https://outlook.office365.com/{0}",autoProvisioningUrl:null,displayAutoProvisioningUrl:!1,emailPopupWindowName:"emailPopupWindow",emailPopupWindowOptions:"menubar=1,scrollbars=1,resizable=1,width=1000,height=600",emailNotificationWindowName:"notificationWindow",emailNotificationWindowOptions:"menubar=1,scrollbars=1,resizable=1,width=1000,height=850",domainName:null,errorMessages:{ConnectionError:{code:0,type:"Connection Error",message:"Unable to connect.",suggestion:"Try again"},UnprovisionedError:{code:1,type:"Unprovisioned Error",message:"We are in the process of setting up your Microsoft Office account. Please check back in 24 hours.",messageForProvisionUrl:"We are in the process of setting up your Microsoft Office account. Please check back in 24 hours or ",suggestion:"set-up your account now."}},clickActions:{InboxClick:"edu.apollogrp.pets.email.emailcontroller.InboxClick.",MessageClick:"edu.apollogrp.pets.email.emailcontroller.MessageClick.",PreferencesIconOpen:"edu.apollogrp.pets.email.emailcontroller.PreferencesIconOpen.",PreferencesIconClose:"edu.apollogrp.pets.email.emailcontroller.PreferencesIconClose.",PreferencesChange:"edu.apollogrp.pets.email.emailcontroller.PreferencesChange."}},f=e;if(d)for(var g in d)if(e.hasOwnProperty(g)){var h=d[g];c.info("PETS-Client-Email::EmailConfig",b.formatString("Setting configuration property: {0}={1}",g,h)),f[g]=h}else c.error("PETS-Client-Email::EmailConfig",b.formatString("Unknown configuration property: {0}"+g));return f});

define("pets-client-email/2.4.0/public/javascript/thirdparty/jquery-dotdotdot", [],function(){function a(a){!function(a){function b(a,b,c){var d=a.children(),f=!1;a.empty();for(var g=0,h=d.length;h>g;g++){var i=d.eq(g);if(a.append(i),c&&a.append(c),e(a,b)){i.remove(),f=!0;break}c&&c.remove()}return f}function c(b,f,g,h,i){var j=b.contents(),k=!1;b.empty();for(var l="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style",m=0,n=j.length;n>m&&!k;m++){var o=j[m],p=a(o);if("undefined"!=typeof o){if(b.append(p),i){var q=b.is(l)?"after":"append";b[q](i)}3==o.nodeType?e(g,h)&&(k=d(p,f,g,h,i)):k=c(p,f,g,h,i),k||i&&i.remove()}}return k}function d(b,c,f,i,j){var k=!1,l=b[0];if("undefined"==typeof l)return!1;for(var m="letter"==i.wrap?"":" ",n=h(l).split(m),o=-1,p=-1,q=0,r=n.length-1;r>=q;){var s=Math.floor((q+r)/2);if(s==p)break;p=s,g(l,n.slice(0,p+1).join(m)+i.ellipsis),e(f,i)?r=p:(o=p,q=p)}if(-1!=o){var t=n.slice(0,o+1).join(m);for(k=!0;a.inArray(t.slice(-1),i.lastCharacter.remove)>-1;)t=t.slice(0,-1);a.inArray(t.slice(-1),i.lastCharacter.noEllipsis)<0&&(t+=i.ellipsis),g(l,t)}else{var u=b.parent();b.remove(),$n=u.contents().eq(-1),k=d($n,c,f,i,j)}return k}function e(a,b){return a.innerHeight()>b.maxHeight}function f(a){return{width:a.innerWidth(),height:a.innerHeight()}}function g(a,b){a.innerText?a.innerText=b:a.nodeValue?a.nodeValue=b:a.textContent&&(a.textContent=b)}function h(a){return a.innerText?a.innerText:a.nodeValue?a.nodeValue:a.textContent?a.textContent:""}function i(b,c){return"undefined"==typeof b?!1:b?"string"==typeof b?(b=a(b,c),b.length?b:!1):"object"==typeof b?"undefined"==typeof b.jquery?!1:b:!1:!1}function j(a){var b=a.innerHeight(),c=["paddingTop","paddingBottom"];for(z=0,l=c.length;z<l;z++){var d=parseInt(a.css(c[z]),10);isNaN(d)&&(d=0),b-=d}return b}function k(a,b){return a?(b="string"==typeof b?"dotdotdot: "+b:["dotdotdot:",b],window.console&&window.console.log&&window.console.log(b),!1):!1}if(!a.fn.dotdotdot){a.fn.dotdotdot=function(d){if(0==this.length)return k(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){a(this).dotdotdot(d)});var g=this;g.data("dotdotdot")&&g.trigger("destroy.dot"),g.bind_events=function(){return g.bind("update.dot",function(d,f){d.preventDefault(),d.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:j(g),l.maxHeight+=l.tolerance,"undefined"!=typeof f&&(("string"==typeof f||f instanceof HTMLElement)&&(f=a("<div />").append(f).contents()),f instanceof a&&(h=f)),q=g.wrapInner('<div class="dotdotdot" />').children(),q.empty().append(h.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var i=!1,k=!1;return n.afterElement&&(i=n.afterElement.clone(!0),n.afterElement.remove()),e(q,l)&&(k="children"==l.wrap?b(q,l,i):c(q,g,q,l,i)),q.replaceWith(q.contents()),q=null,a.isFunction(l.callback)&&l.callback.call(g[0],k,h),n.isTruncated=k,k}).bind("isTruncated.dot",function(a,b){return a.preventDefault(),a.stopPropagation(),"function"==typeof b&&b.call(g[0],n.isTruncated),n.isTruncated}).bind("originalContent.dot",function(a,b){return a.preventDefault(),a.stopPropagation(),"function"==typeof b&&b.call(g[0],h),h}).bind("destroy.dot",function(a){a.preventDefault(),a.stopPropagation(),g.unwatch().unbind_events().empty().append(h).data("dotdotdot",!1)}),g},g.unbind_events=function(){return g.unbind(".dot"),g},g.watch=function(){if(g.unwatch(),"window"==l.watch){var b=a(window),c=b.width(),d=b.height();b.bind("resize.dot"+n.dotId,function(){c==b.width()&&d==b.height()&&l.windowResizeFix||(c=b.width(),d=b.height(),p&&clearInterval(p),p=setTimeout(function(){g.trigger("update.dot")},10))})}else o=f(g),p=setInterval(function(){var a=f(g);(o.width!=a.width||o.height!=a.height)&&(g.trigger("update.dot"),o=f(g))},100);return g},g.unwatch=function(){return a(window).unbind("resize.dot"+n.dotId),p&&clearInterval(p),g};var h=g.contents(),l=a.extend(!0,{},a.fn.dotdotdot.defaults,d),n={},o={},p=null,q=null;return n.afterElement=i(l.after,g),n.isTruncated=!1,n.dotId=m++,g.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&g.watch(),g},a.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1};var m=1,n=a.fn.html;a.fn.html=function(a){return"undefined"!=typeof a?this.data("dotdotdot")&&"function"!=typeof a?this.trigger("update",[a]):n.call(this,a):n.call(this)};var o=a.fn.text;a.fn.text=function(b){if("undefined"!=typeof b){if(this.data("dotdotdot")){var c=a("<div />");return c.text(b),b=c.html(),c.remove(),this.trigger("update",[b])}return o.call(this,b)}return o.call(this)}}}(a)}return{init:a}});

define("pets-client-email/2.4.0/public/javascript/thirdparty/sjcl", [],function(a){"use strict";var a={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message},this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message},this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message},this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message},this.message=a}}};return"undefined"!=typeof module&&module.exports&&(module.exports=a),a.cipher.aes=function(b){this._tables[0][0][0]||this._precompute();var c,d,e,f,g,h=this._tables[0][4],i=this._tables[1],j=b.length,k=1;if(4!==j&&6!==j&&8!==j)throw new a.exception.invalid("invalid aes key size");for(this._key=[f=b.slice(0),g=[]],c=j;4*j+28>c;c++)e=f[c-1],(c%j===0||8===j&&c%j===4)&&(e=h[e>>>24]<<24^h[e>>16&255]<<16^h[e>>8&255]<<8^h[255&e],c%j===0&&(e=e<<8^e>>>24^k<<24,k=k<<1^283*(k>>7))),f[c]=f[c-j]^e;for(d=0;c;d++,c--)e=f[3&d?c:c-4],g[d]=4>=c||4>d?e:i[0][h[e>>>24]]^i[1][h[e>>16&255]]^i[2][h[e>>8&255]]^i[3][h[255&e]]},a.cipher.aes.prototype={encrypt:function(a){return this._crypt(a,0)},decrypt:function(a){return this._crypt(a,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e,f,g,h,i,j=this._tables[0],k=this._tables[1],l=j[4],m=k[4],n=[],o=[];for(a=0;256>a;a++)o[(n[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!l[b];b^=d||1,c=o[c]||1)for(g=c^c<<1^c<<2^c<<3^c<<4,g=g>>8^255&g^99,l[b]=g,m[g]=b,f=n[e=n[d=n[b]]],i=16843009*f^65537*e^257*d^16843008*b,h=257*n[g]^16843008*g,a=0;4>a;a++)j[a][b]=h=h<<24^h>>>8,k[a][g]=i=i<<24^i>>>8;for(a=0;5>a;a++)j[a]=j[a].slice(0),k[a]=k[a].slice(0)},_crypt:function(b,c){if(4!==b.length)throw new a.exception.invalid("invalid aes block size");var d,e,f,g,h=this._key[c],i=b[0]^h[0],j=b[c?3:1]^h[1],k=b[2]^h[2],l=b[c?1:3]^h[3],m=h.length/4-2,n=4,o=[0,0,0,0],p=this._tables[c],q=p[0],r=p[1],s=p[2],t=p[3],u=p[4];for(g=0;m>g;g++)d=q[i>>>24]^r[j>>16&255]^s[k>>8&255]^t[255&l]^h[n],e=q[j>>>24]^r[k>>16&255]^s[l>>8&255]^t[255&i]^h[n+1],f=q[k>>>24]^r[l>>16&255]^s[i>>8&255]^t[255&j]^h[n+2],l=q[l>>>24]^r[i>>16&255]^s[j>>8&255]^t[255&k]^h[n+3],n+=4,i=d,j=e,k=f;for(g=0;4>g;g++)o[c?3&-g:g]=u[i>>>24]<<24^u[j>>16&255]<<16^u[k>>8&255]<<8^u[255&l]^h[n++],d=i,i=j,j=k,k=l,l=d;return o}},a.bitArray={bitSlice:function(b,c,d){return b=a.bitArray._shiftRight(b.slice(c/32),32-(31&c)).slice(1),void 0===d?b:a.bitArray.clamp(b,d-c)},extract:function(a,b,c){var d,e=Math.floor(-b-c&31);return d=-32&(b+c-1^b)?a[b/32|0]<<32-e^a[b/32+1|0]>>>e:a[b/32|0]>>>e,d&(1<<c)-1},concat:function(b,c){if(0===b.length||0===c.length)return b.concat(c);var d=b[b.length-1],e=a.bitArray.getPartial(d);return 32===e?b.concat(c):a.bitArray._shiftRight(c,e,0|d,b.slice(0,b.length-1))},bitLength:function(b){var c,d=b.length;return 0===d?0:(c=b[d-1],32*(d-1)+a.bitArray.getPartial(c))},clamp:function(b,c){if(32*b.length<c)return b;b=b.slice(0,Math.ceil(c/32));var d=b.length;return c=31&c,d>0&&c&&(b[d-1]=a.bitArray.partial(c,b[d-1]&2147483648>>c-1,1)),b},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(b,c){if(a.bitArray.bitLength(b)!==a.bitArray.bitLength(c))return!1;var d,e=0;for(d=0;d<b.length;d++)e|=b[d]^c[d];return 0===e},_shiftRight:function(b,c,d,e){var f,g,h=0;for(void 0===e&&(e=[]);c>=32;c-=32)e.push(d),d=0;if(0===c)return e.concat(b);for(f=0;f<b.length;f++)e.push(d|b[f]>>>c),d=b[f]<<32-c;return h=b.length?b[b.length-1]:0,g=a.bitArray.getPartial(h),e.push(a.bitArray.partial(c+g&31,c+g>32?d:e.pop(),1)),e},_xor4:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}},a.codec.utf8String={fromBits:function(b){var c,d,e="",f=a.bitArray.bitLength(b);for(c=0;f/8>c;c++)0===(3&c)&&(d=b[c/4]),e+=String.fromCharCode(d>>>24),d<<=8;return decodeURIComponent(escape(e))},toBits:function(b){b=unescape(encodeURIComponent(b));var c,d=[],e=0;for(c=0;c<b.length;c++)e=e<<8|b.charCodeAt(c),3===(3&c)&&(d.push(e),e=0);return 3&c&&d.push(a.bitArray.partial(8*(3&c),e)),d}},a.codec.hex={fromBits:function(b){var c,d="";for(c=0;c<b.length;c++)d+=((0|b[c])+0xf00000000000).toString(16).substr(4);return d.substr(0,a.bitArray.bitLength(b)/4)},toBits:function(b){var c,d,e=[];for(b=b.replace(/\s|0x/g,""),d=b.length,b+="00000000",c=0;c<b.length;c+=8)e.push(0^parseInt(b.substr(c,8),16));return a.bitArray.clamp(e,4*d)}},a.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(b,c,d){var e,f="",g=0,h=a.codec.base64._chars,i=0,j=a.bitArray.bitLength(b);for(d&&(h=h.substr(0,62)+"-_"),e=0;6*f.length<j;)f+=h.charAt((i^b[e]>>>g)>>>26),6>g?(i=b[e]<<6-g,g+=26,e++):(i<<=6,g-=6);for(;3&f.length&&!c;)f+="=";return f},toBits:function(b,c){b=b.replace(/\s|=/g,"");var d,e,f=[],g=0,h=a.codec.base64._chars,i=0;for(c&&(h=h.substr(0,62)+"-_"),d=0;d<b.length;d++){if(e=h.indexOf(b.charAt(d)),0>e)throw new a.exception.invalid("this isn't base64!");g>26?(g-=26,f.push(i^e>>>g),i=e<<32-g):(g+=6,i^=e<<32-g)}return 56&g&&f.push(a.bitArray.partial(56&g,i,1)),f}},a.codec.base64url={fromBits:function(b){return a.codec.base64.fromBits(b,1,1)},toBits:function(b){return a.codec.base64.toBits(b,1)}},a.hash.sha256=function(a){this._key[0]||this._precompute(),a?(this._h=a._h.slice(0),this._buffer=a._buffer.slice(0),this._length=a._length):this.reset()},a.hash.sha256.hash=function(b){return(new a.hash.sha256).update(b).finalize()},a.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(b){"string"==typeof b&&(b=a.codec.utf8String.toBits(b));var c,d=this._buffer=a.bitArray.concat(this._buffer,b),e=this._length,f=this._length=e+a.bitArray.bitLength(b);for(c=512+e&-512;f>=c;c+=512)this._block(d.splice(0,16));return this},finalize:function(){var b,c=this._buffer,d=this._h;for(c=a.bitArray.concat(c,[a.bitArray.partial(1,1)]),b=c.length+2;15&b;b++)c.push(0);for(c.push(Math.floor(this._length/4294967296)),c.push(0|this._length);c.length;)this._block(c.splice(0,16));return this.reset(),d},_init:[],_key:[],_precompute:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}var b,c=0,d=2;a:for(;64>c;d++){for(b=2;d>=b*b;b++)if(d%b===0)continue a;8>c&&(this._init[c]=a(Math.pow(d,.5))),this._key[c]=a(Math.pow(d,1/3)),c++}},_block:function(a){var b,c,d,e,f=a.slice(0),g=this._h,h=this._key,i=g[0],j=g[1],k=g[2],l=g[3],m=g[4],n=g[5],o=g[6],p=g[7];for(b=0;64>b;b++)16>b?c=f[b]:(d=f[b+1&15],e=f[b+14&15],c=f[15&b]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[15&b]+f[b+9&15]|0),c=c+p+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(o^m&(n^o))+h[b],p=o,o=n,n=m,m=l+c|0,l=k,k=j,j=i,i=c+(j&k^l&(j^k))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0;g[0]=g[0]+i|0,g[1]=g[1]+j|0,g[2]=g[2]+k|0,g[3]=g[3]+l|0,g[4]=g[4]+m|0,g[5]=g[5]+n|0,g[6]=g[6]+o|0,g[7]=g[7]+p|0}},a.mode.ccm={name:"ccm",encrypt:function(b,c,d,e,f){var g,h,i=c.slice(0),j=a.bitArray,k=j.bitLength(d)/8,l=j.bitLength(i)/8;if(f=f||64,e=e||[],7>k)throw new a.exception.invalid("ccm: iv must be at least 7 bytes");for(g=2;4>g&&l>>>8*g;g++);return 15-k>g&&(g=15-k),d=j.clamp(d,8*(15-g)),h=a.mode.ccm._computeTag(b,c,d,e,f,g),i=a.mode.ccm._ctrMode(b,i,d,h,f,g),j.concat(i.data,i.tag)},decrypt:function(b,c,d,e,f){f=f||64,e=e||[];var g,h,i=a.bitArray,j=i.bitLength(d)/8,k=i.bitLength(c),l=i.clamp(c,k-f),m=i.bitSlice(c,k-f);if(k=(k-f)/8,7>j)throw new a.exception.invalid("ccm: iv must be at least 7 bytes");for(g=2;4>g&&k>>>8*g;g++);if(15-j>g&&(g=15-j),d=i.clamp(d,8*(15-g)),l=a.mode.ccm._ctrMode(b,l,d,m,f,g),h=a.mode.ccm._computeTag(b,l.data,d,e,f,g),!i.equal(l.tag,h))throw new a.exception.corrupt("ccm: tag doesn't match");return l.data},_computeTag:function(b,c,d,e,f,g){var h,i,j,k=[],l=a.bitArray,m=l._xor4;if(f/=8,f%2||4>f||f>16)throw new a.exception.invalid("ccm: invalid tag length");if(e.length>4294967295||c.length>4294967295)throw new a.exception.bug("ccm: can't deal with 4GiB or more data");if(h=[l.partial(8,(e.length?64:0)|f-2<<2|g-1)],h=l.concat(h,d),h[3]|=l.bitLength(c)/8,h=b.encrypt(h),e.length)for(i=l.bitLength(e)/8,65279>=i?k=[l.partial(16,i)]:4294967295>=i&&(k=l.concat([l.partial(16,65534)],[i])),k=l.concat(k,e),j=0;j<k.length;j+=4)h=b.encrypt(m(h,k.slice(j,j+4).concat([0,0,0])));for(j=0;j<c.length;j+=4)h=b.encrypt(m(h,c.slice(j,j+4).concat([0,0,0])));return l.clamp(h,8*f)},_ctrMode:function(b,c,d,e,f,g){var h,i,j,k=a.bitArray,l=k._xor4,m=c.length,n=k.bitLength(c);if(j=k.concat([k.partial(8,g-1)],d).concat([0,0,0]).slice(0,4),e=k.bitSlice(l(e,b.encrypt(j)),0,f),!m)return{tag:e,data:[]};for(i=0;m>i;i+=4)j[3]++,h=b.encrypt(j),c[i]^=h[0],c[i+1]^=h[1],c[i+2]^=h[2],c[i+3]^=h[3];return{tag:e,data:k.clamp(c,n)}}},a.mode.ocb2={name:"ocb2",encrypt:function(b,c,d,e,f,g){if(128!==a.bitArray.bitLength(d))throw new a.exception.invalid("ocb iv must be 128 bits");var h,i,j,k,l=a.mode.ocb2._times2,m=a.bitArray,n=m._xor4,o=[0,0,0,0],p=l(b.encrypt(d)),q=[];for(e=e||[],f=f||64,h=0;h+4<c.length;h+=4)i=c.slice(h,h+4),o=n(o,i),q=q.concat(n(p,b.encrypt(n(p,i)))),p=l(p);return i=c.slice(h),j=m.bitLength(i),k=b.encrypt(n(p,[0,0,0,j])),i=m.clamp(n(i.concat([0,0,0]),k),j),o=n(o,n(i.concat([0,0,0]),k)),o=b.encrypt(n(o,n(p,l(p)))),e.length&&(o=n(o,g?e:a.mode.ocb2.pmac(b,e))),q.concat(m.concat(i,m.clamp(o,f)))},decrypt:function(b,c,d,e,f,g){if(128!==a.bitArray.bitLength(d))throw new a.exception.invalid("ocb iv must be 128 bits");f=f||64;var h,i,j,k,l=a.mode.ocb2._times2,m=a.bitArray,n=m._xor4,o=[0,0,0,0],p=l(b.encrypt(d)),q=a.bitArray.bitLength(c)-f,r=[];for(e=e||[],h=0;q/32>h+4;h+=4)i=n(p,b.decrypt(n(p,c.slice(h,h+4)))),o=n(o,i),r=r.concat(i),p=l(p);if(j=q-32*h,k=b.encrypt(n(p,[0,0,0,j])),i=n(k,m.clamp(c.slice(h),j).concat([0,0,0])),o=n(o,i),o=b.encrypt(n(o,n(p,l(p)))),e.length&&(o=n(o,g?e:a.mode.ocb2.pmac(b,e))),!m.equal(m.clamp(o,f),m.bitSlice(c,q)))throw new a.exception.corrupt("ocb: tag doesn't match");return r.concat(m.clamp(i,j))},pmac:function(b,c){var d,e,f=a.mode.ocb2._times2,g=a.bitArray,h=g._xor4,i=[0,0,0,0],j=b.encrypt([0,0,0,0]);for(j=h(j,f(f(j))),d=0;d+4<c.length;d+=4)j=f(j),i=h(i,b.encrypt(h(j,c.slice(d,d+4))));return e=c.slice(d),g.bitLength(e)<128&&(j=h(j,f(j)),e=g.concat(e,[-2147483648,0,0,0])),i=h(i,e),b.encrypt(h(f(h(j,f(j))),i))},_times2:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}},a.misc.hmac=function(b,c){this._hash=c=c||a.hash.sha256;var d,e=[[],[]],f=c.prototype.blockSize/32;for(this._baseHash=[new c,new c],b.length>f&&(b=c.hash(b)),d=0;f>d;d++)e[0][d]=909522486^b[d],e[1][d]=1549556828^b[d];this._baseHash[0].update(e[0]),this._baseHash[1].update(e[1])},a.misc.hmac.prototype.encrypt=a.misc.hmac.prototype.mac=function(a,b){var c=new this._hash(this._baseHash[0]).update(a,b).finalize();return new this._hash(this._baseHash[1]).update(c).finalize()},a.misc.pbkdf2=function(b,c,d,e,f){if(d=d||1e3,0>e||0>d)throw a.exception.invalid("invalid params to pbkdf2");"string"==typeof b&&(b=a.codec.utf8String.toBits(b)),f=f||a.misc.hmac;var g,h,i,j,k,l=new f(b),m=[],n=a.bitArray;for(k=1;32*m.length<(e||1);k++){for(g=h=l.encrypt(n.concat(c,[k])),i=1;d>i;i++)for(h=l.encrypt(h),j=0;j<h.length;j++)g[j]^=h[j];m=m.concat(g)}return e&&(m=n.clamp(m,e)),m},a.random={randomWords:function(b,c){var d,e,f=[],g=this.isReady(c);if(g===this._NOT_READY)throw new a.exception.notReady("generator isn't seeded");for(g&this._REQUIRES_RESEED&&this._reseedFromPools(!(g&this._READY)),d=0;b>d;d+=4)(d+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),e=this._gen4words(),f.push(e[0],e[1],e[2],e[3]);return this._gate(),f.slice(0,b)},setDefaultParanoia:function(a){this._defaultParanoia=a},addEntropy:function(b,c,d){d=d||"user";var e,f,g,h=(new Date).valueOf(),i=this._robins[d],j=this.isReady(),k=0;switch(e=this._collectorIds[d],void 0===e&&(e=this._collectorIds[d]=this._collectorIdNext++),void 0===i&&(i=this._robins[d]=0),this._robins[d]=(this._robins[d]+1)%this._pools.length,typeof b){case"number":void 0===c&&(c=1),this._pools[i].update([e,this._eventId++,1,c,h,1,0|b]);break;case"object":var l=Object.prototype.toString.call(b);if("[object Uint32Array]"===l){for(g=[],f=0;f<b.length;f++)g.push(b[f]);b=g}else for("[object Array]"!==l&&(k=1),f=0;f<b.length&&!k;f++)"number"!=typeof b[f]&&(k=1);if(!k){if(void 0===c)for(c=0,f=0;f<b.length;f++)for(g=b[f];g>0;)c++,g>>>=1;this._pools[i].update([e,this._eventId++,2,c,h,b.length].concat(b))}break;case"string":void 0===c&&(c=b.length),this._pools[i].update([e,this._eventId++,3,c,h,b.length]),this._pools[i].update(b);break;default:k=1}if(k)throw new a.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[i]+=c,this._poolStrength+=c,j===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(a){var b=this._PARANOIA_LEVELS[void 0!==a?a:this._defaultParanoia];return this._strength&&this._strength>=b?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=b?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(a){var b=this._PARANOIA_LEVELS[a?a:this._defaultParanoia];return this._strength>=b?1:this._poolStrength>b?1:this._poolStrength/b},startCollectors:function(){if(!this._collectorsStarted){if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new a.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(a,b){this._callbacks[a][this._callbackI++]=b},removeEventListener:function(a,b){var c,d,e=this._callbacks[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},_pools:[new a.hash.sha256],_poolEntropy:[0],_reseedCount:0,_robins:{},_eventId:0,_collectorIds:{},_collectorIdNext:0,_strength:0,_poolStrength:0,_nextReseed:0,_key:[0,0,0,0,0,0,0,0],_counter:[0,0,0,0],_cipher:void 0,_defaultParanoia:6,_collectorsStarted:!1,_callbacks:{progress:{},seeded:{}},_callbackI:0,_NOT_READY:0,_READY:1,_REQUIRES_RESEED:2,_MAX_WORDS_PER_BURST:65536,_PARANOIA_LEVELS:[0,48,64,96,128,192,256,384,512,768,1024],_MILLISECONDS_PER_RESEED:3e4,_BITS_PER_RESEED:80,_gen4words:function(){for(var a=0;4>a&&(this._counter[a]=this._counter[a]+1|0,!this._counter[a]);a++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new a.cipher.aes(this._key)},_reseed:function(b){this._key=a.hash.sha256.hash(this._key.concat(b)),this._cipher=new a.cipher.aes(this._key);for(var c=0;4>c&&(this._counter[c]=this._counter[c]+1|0,!this._counter[c]);c++);},_reseedFromPools:function(b){var c,d=[],e=0;for(this._nextReseed=d[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,c=0;16>c;c++)d.push(4294967296*Math.random()|0);for(c=0;c<this._pools.length&&(d=d.concat(this._pools[c].finalize()),e+=this._poolEntropy[c],this._poolEntropy[c]=0,b||!(this._reseedCount&1<<c));c++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new a.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=e,e>this._strength&&(this._strength=e),this._reseedCount++,this._reseed(d)},_mouseCollector:function(b){var c=b.x||b.clientX||b.offsetX||0,d=b.y||b.clientY||b.offsetY||0;a.random.addEntropy([c,d],2,"mouse")},_loadTimeCollector:function(){a.random.addEntropy((new Date).valueOf(),2,"loadtime")},_fireEvent:function(b,c){var d,e=a.random._callbacks[b],f=[];for(d in e)e.hasOwnProperty(d)&&f.push(e[d]);for(d=0;d<f.length;d++)f[d](c)}},function(){try{var b=new Uint32Array(32);crypto.getRandomValues(b),a.random.addEntropy(b,1024,"crypto.getRandomValues")}catch(c){}}(),a.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(b,c,d,e){d=d||{},e=e||{};var f,g,h,i=a.json,j=i._add({iv:a.random.randomWords(4,0)},i.defaults);if(i._add(j,d),h=j.adata,"string"==typeof j.salt&&(j.salt=a.codec.base64.toBits(j.salt)),"string"==typeof j.iv&&(j.iv=a.codec.base64.toBits(j.iv)),!a.mode[j.mode]||!a.cipher[j.cipher]||"string"==typeof b&&j.iter<=100||64!==j.ts&&96!==j.ts&&128!==j.ts||128!==j.ks&&192!==j.ks&&256!==j.ks||j.iv.length<2||j.iv.length>4)throw new a.exception.invalid("json encrypt: invalid parameters");return"string"==typeof b&&(f=a.misc.cachedPbkdf2(b,j),b=f.key.slice(0,j.ks/32),j.salt=f.salt),"string"==typeof c&&(c=a.codec.utf8String.toBits(c)),"string"==typeof h&&(h=a.codec.utf8String.toBits(h)),g=new a.cipher[j.cipher](b),i._add(e,j),e.key=b,j.ct=a.mode[j.mode].encrypt(g,c,j.iv,h,j.ts),i.encode(j)},decrypt:function(b,c,d,e){d=d||{},e=e||{};var f,g,h,i=a.json,j=i._add(i._add(i._add({},i.defaults),i.decode(c)),d,!0),k=j.adata;if("string"==typeof j.salt&&(j.salt=a.codec.base64.toBits(j.salt)),"string"==typeof j.iv&&(j.iv=a.codec.base64.toBits(j.iv)),!a.mode[j.mode]||!a.cipher[j.cipher]||"string"==typeof b&&j.iter<=100||64!==j.ts&&96!==j.ts&&128!==j.ts||128!==j.ks&&192!==j.ks&&256!==j.ks||!j.iv||j.iv.length<2||j.iv.length>4)throw new a.exception.invalid("json decrypt: invalid parameters");return"string"==typeof b&&(g=a.misc.cachedPbkdf2(b,j),b=g.key.slice(0,j.ks/32),j.salt=g.salt),"string"==typeof k&&(k=a.codec.utf8String.toBits(k)),h=new a.cipher[j.cipher](b),f=a.mode[j.mode].decrypt(h,j.ct,j.iv,k,j.ts),i._add(e,j),e.key=b,a.codec.utf8String.fromBits(f)},encode:function(b){var c,d="{",e="";for(c in b)if(b.hasOwnProperty(c)){if(!c.match(/^[a-z0-9]+$/i))throw new a.exception.invalid("json encode: invalid property name");switch(d+=e+'"'+c+'":',e=",",typeof b[c]){case"number":case"boolean":d+=b[c];break;case"string":d+='"'+escape(b[c])+'"';break;case"object":d+='"'+a.codec.base64.fromBits(b[c],1)+'"';break;default:throw new a.exception.bug("json encode: unsupported type")}}return d+"}"},decode:function(b){if(b=b.replace(/\s/g,""),!b.match(/^\{.*\}$/))throw new a.exception.invalid("json decode: this isn't json!");var c,d,e=b.replace(/^\{|\}$/g,"").split(/,/),f={};for(c=0;c<e.length;c++){if(!(d=e[c].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new a.exception.invalid("json decode: this isn't json!");f[d[2]]=d[3]?parseInt(d[3],10):d[2].match(/^(ct|salt|iv)$/)?a.codec.base64.toBits(d[4]):unescape(d[4])}return f},_add:function(b,c,d){if(void 0===b&&(b={}),void 0===c)return b;var e;for(e in c)if(c.hasOwnProperty(e)){if(d&&void 0!==b[e]&&b[e]!==c[e])throw new a.exception.invalid("required parameter overridden");b[e]=c[e]}return b},_subtract:function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&a[c]!==b[c]&&(d[c]=a[c]);return d},_filter:function(a,b){var c,d={};for(c=0;c<b.length;c++)void 0!==a[b[c]]&&(d[b[c]]=a[b[c]]);return d}},a.encrypt=a.json.encrypt,a.decrypt=a.json.decrypt,a.misc._pbkdf2Cache={},a.misc.cachedPbkdf2=function(b,c){var d,e,f,g,h=a.misc._pbkdf2Cache;return c=c||{},g=c.iter||1e3,e=h[b]=h[b]||{},d=e[g]=e[g]||{firstSalt:c.salt&&c.salt.length?c.salt.slice(0):a.random.randomWords(2,0)},f=void 0===c.salt?d.firstSalt:c.salt,d[f]=d[f]||a.misc.pbkdf2(b,f,c.iter),{key:d[f].slice(0),salt:f.slice(0)}},a});

define('pets-client-email/2.4.0/public/partialsClient/emailCalc.compiled', ['ncf-templating/dust-1.2.2/public/javascript/dust'],function(dust){
 (function(){dust.register("/te/pets-client-email/2.4.0/public/partialsClient/emailCalc.template",body_0);function body_0(chk, ctx){return chk.write("<div class=\"aes-email-calc\"><div class=\"aes-email-calc-inner\"></div></div>");}return body_0;})();; return { path: '/te/pets-client-email/2.4.0/public/partialsClient/emailCalc.template' };
});
require(['pets-client-email/2.4.0/public/partialsClient/emailCalc.compiled'],function(){});

define('pets-client-email/2.4.0/public/partialsClient/emailFooter.compiled', ['ncf-templating/dust-1.2.2/public/javascript/dust'],function(dust){
 (function(){dust.register("/te/pets-client-email/2.4.0/public/partialsClient/emailFooter.template",body_0);function body_0(chk, ctx){return chk.exists(ctx.getPath(true,["folderSummary","address"]),ctx,{"block":body_1},null);}function body_1(chk, ctx){return chk.write("<div class=\"aes-footer-inner\"><ul><li><time datetime=\"").section(ctx.get("formatTimestampToISO"),ctx,{},{"value":ctx.getPath(true,["folderSummary","updateDateTime"])}).write("\">").section(ctx.get("formatTimestamp"),ctx,{},{"value":ctx.getPath(true,["folderSummary","updateDateTime"])}).write("</time></li><li><button class=\"aes-pets-icon-button aes-refresh\" id=\"aes-dock-email-refresh\" title=\"Click to load recent emails\"><img class=\"aes-pets-icon aes-refresh\" src=\"/te/pets-client-core/2.6.0/public/img/empty.png\" alt=\"refresh\" /></button></li><li><button class=\"aes-pets-icon-button aes-preferences\" id=\"aes-dock-email-preferences\" data-num-lines=\"").reference(ctx.getPath(true,["options","lineCount"]),ctx,"h").write("\" aria-expanded=\"false\" aria-controls=\"aes-dock-email-preferences-flyout\" title=\"Click to change your mail view preferences\"><img class=\"aes-pets-icon aes-preferences\" src=\"/te/pets-client-core/2.6.0/public/img/empty.png\" alt=\"preferences\" /></button><form id=\"aes-dock-email-preferences-flyout\" class=\"aes-flyout\"><h2>Messages</h2><label for=\"aes-dock-email-preferences-lines\"><span class=\"aes-pets-sr-only\">Select how many lines to </span>Show<span class=\"aes-pets-sr-only\"> in each email view</span></label><select id=\"aes-dock-email-preferences-lines\"><option value=\"1\">1 line</option><option value=\"2\">2 lines</option><option value=\"3\">3 lines</option><option value=\"4\">4 lines</option></select></form></li></ul></div>");}return body_0;})();; return { path: '/te/pets-client-email/2.4.0/public/partialsClient/emailFooter.template' };
});
require(['pets-client-email/2.4.0/public/partialsClient/emailFooter.compiled'],function(){});

define('pets-client-email/2.4.0/public/partialsClient/emailList.compiled', ['ncf-templating/dust-1.2.2/public/javascript/dust'],function(dust){
 (function(){dust.register("/te/pets-client-email/2.4.0/public/partialsClient/emailList.template",body_0);function body_0(chk, ctx){return chk.write("<div class=\"aes-list-inner\">").exists(ctx.get("error"),ctx,{"block":body_1},null).exists(ctx.getPath(false,["folderSummary","address"]),ctx,{"else":body_2,"block":body_4},null).write("</div>");}function body_1(chk, ctx){return chk.write("<p class=\"aes-pets-messages aes-error\">").reference(ctx.getPath(false,["error","message"]),ctx,"h").write(" <a id=\"aes-dock-email-error\" data-type=\"").reference(ctx.getPath(false,["error","type"]),ctx,"h").write("\">").reference(ctx.getPath(false,["error","suggestion"]),ctx,"h").write("</a></p>");}function body_2(chk, ctx){return chk.notexists(ctx.get("error"),ctx,{"block":body_3},null);}function body_3(chk, ctx){return chk.write("<p class=\"aes-pets-messages\">Loading emails...</p>").partial("/te/pets-client-core/2.6.0/public/partialsClient/dock/browsernotice.template",ctx,null);}function body_4(chk, ctx){return chk.exists(ctx.getPath(false,["folderSummary","emailMessageInfo"]),ctx,{"else":body_5,"block":body_6},null);}function body_5(chk, ctx){return chk.write("<p class=\"aes-pets-messages\">You have no emails in your inbox.</p>");}function body_6(chk, ctx){return chk.write("<ul>").section(ctx.getPath(true,["folderSummary","emailMessageInfo"]),ctx,{"block":body_7},null).write("</ul><p class=\"aes-message-count\"><a id=\"aes-dock-email-see-all\" href=\"#\">Go to<span class=\"aes-pets-sr-only\"> Email</span> inbox</a></p>");}function body_7(chk, ctx){return chk.write("<li id=\"aes-dock-email-message-").helper("idx",ctx,{"block":body_8},null).write("\" class=\"aes-email-message").notexists(ctx.get("seen"),ctx,{"block":body_9},null).write("\"><div class=\"aes-pets-email-header\"><h2 class=\"aes-pets-email-sender\">").section(ctx.get("formatSenderName"),ctx,{},{"sender":ctx.getPath(true,["sender"])}).write("</h2><div class=\"aes-pets-email-attributes\">").exists(ctx.get("attachment"),ctx,{"block":body_10},null).write("<span class=\"aes-pets-sr-only\">").notexists(ctx.get("seen"),ctx,{"else":body_11,"block":body_12},null).write(",</span><span class=\"aes-pets-sr-only\">sent</span><time datetime=\"").section(ctx.get("formatTimestampToISO"),ctx,{},{"value":ctx.getPath(true,["sent"])}).write("\">").section(ctx.get("formatTimestamp"),ctx,{},{"value":ctx.getPath(true,["sent"])}).write("</time></div></div><div class=\"aes-pets-email-message\"><div class=\"aes-pets-email-subject\"><a href=\"").reference(ctx.get("uri"),ctx,"h").write("\" title=\"Click to view email: ").reference(ctx.get("subject"),ctx,"h",["s"]).write("\" id=\"aes-dock-email-subject-").helper("idx",ctx,{"block":body_13},null).write("\">").exists(ctx.get("subject"),ctx,{"else":body_14,"block":body_15},null).write("</a></div><p id=\"aes-dock-email-body-").helper("idx",ctx,{"block":body_16},null).write("\">- ").reference(ctx.get("bodySummary"),ctx,"h",["s"]).write("</p></div></li>");}function body_8(chk, ctx){return chk.reference(ctx.getPath(true,[]),ctx,"h");}function body_9(chk, ctx){return chk.write(" aes-unread");}function body_10(chk, ctx){return chk.write("<span class=\"aes-pets-icon aes-attachment\"></span>");}function body_11(chk, ctx){return chk.write("email has been read");}function body_12(chk, ctx){return chk.write("email is unread");}function body_13(chk, ctx){return chk.reference(ctx.getPath(true,[]),ctx,"h");}function body_14(chk, ctx){return chk.write("(No Subject)");}function body_15(chk, ctx){return chk.reference(ctx.get("subject"),ctx,"h",["s"]);}function body_16(chk, ctx){return chk.reference(ctx.getPath(true,[]),ctx,"h");}return body_0;})();; return { path: '/te/pets-client-email/2.4.0/public/partialsClient/emailList.template' };
});
require(['pets-client-email/2.4.0/public/partialsClient/emailList.compiled'],function(){});

define('pets-client-email/2.4.0/public/partialsClient/emailNotification.compiled', ['ncf-templating/dust-1.2.2/public/javascript/dust'],function(dust){
 (function(){dust.register("/te/pets-client-email/2.4.0/public/partialsClient/emailNotification.template",body_0);function body_0(chk, ctx){return chk.exists(ctx.getPath(false,["folderSummary","address"]),ctx,{"block":body_1},null);}function body_1(chk, ctx){return chk.write("<p class=\"aes-pets-messages\"><em>Missing email?</em><br/><a id=\"aes-email-notification-link\" href=\"/te/pets-client-email/public/recover-google.html\">Click here to learn why and find out how to access your old mailbox.</a></p>");}return body_0;})();; return { path: '/te/pets-client-email/2.4.0/public/partialsClient/emailNotification.template' };
});
require(['pets-client-email/2.4.0/public/partialsClient/emailNotification.compiled'],function(){});

define('pets-client-email/2.4.0/public/partialsClient/emailheadercontrol.compiled', ['ncf-templating/dust-1.2.2/public/javascript/dust'],function(dust){
 (function(){dust.register("/te/pets-client-email/2.4.0/public/partialsClient/emailheadercontrol.template",body_0);function body_0(chk, ctx){return chk.write("<input id=\"aes-email-inbox-link\" title=\"Click to open Email Inbox\" type=\"submit\" value=\"Inbox\"/>");}return body_0;})();; return { path: '/te/pets-client-email/2.4.0/public/partialsClient/emailheadercontrol.template' };
});
require(['pets-client-email/2.4.0/public/partialsClient/emailheadercontrol.compiled'],function(){});

define("pets-client-email/2.4.0/public/javascript/emailtracker", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/analytics","pets-client-email/2.4.0/public/javascript/emailconfig"],function(a,b,c,d,e){function f(b,d){var f=e.EmailServiceURI.LOG_DATA,i=j(),k=b+" URL: "+i;c.isUndefinedOrNull(d)||""===d||(k+=" | "+d);var l='{"message":"'+k+'"}';a.ajax({url:f,type:"POST",data:l,contentType:"application/json",success:g,error:h})}function g(){b.trace("PETs-Email::EmailTracker::logToEmailCDS::loggingSuccess"),b.debug("PETs-Email::EmailTracker::logToEmailCDS::loggingSuccess")}function h(){b.trace("PETs-Email::EmailTracker::logToEmailCDS::loggingFailure"),b.debug("PETs-Email::EmailTracker::logToEmailCDS::loggingFailure")}function i(a,c){b.trace("PETs-Email::EmailTracker::gaTrackEvent","action: "+a+" label: "+c),b.debug("PETs-Email::EmailTracker::gaTrackEvent","action: "+a+" label: "+c),d.publishEvent(a,m,c)}function j(){return document.location.href}function k(){return n}function l(){return o}b.trace("Pets-Email::EmailTracker::ctor");var m="PETS-Email",n={GoToInbox:"goto-inbox",EmailOpen:"email-open",PreferencesOpen:"preferences",PreferencesClose:"preferences",PreferencesChange:"preferences-change",Refresh:"refresh"},o={GoToInbox:"Go to Inbox",EmailOpen:"Email Open",PreferencesOpen:"Preferences",PreferencesClose:"Preferences",PreferencesChange:"Preferences Change",Refresh:"Refresh"};return{logToEmailCDS:f,gaTrackEvent:i,gaGetPageUrl:j,getAnalyticsEvents:k,getBILoggingEvents:l}});

define('pets-client-email/2.4.0/public/partialsClient/email.compiled', ['ncf-templating/dust-1.2.2/public/javascript/dust'],function(dust){
 (function(){dust.register("/te/pets-client-email/2.4.0/public/partialsClient/email.template",body_0);function body_0(chk, ctx){return chk.write("<div id=\"aes-dock-email\" class=\"aes-dock-content\"><div id=\"aes-email-inbox-link-control\"data-controlfactory=\"pets-client-email/2.4.0/public/javascript/emailheadercontrol\"data-widget-options=\"resizeToParentClientArea=false\"></div><div id=\"aes-email-notification\">").partial("/te/pets-client-email/2.4.0/public/partialsClient/emailNotification.template",ctx,null).write("</div><div id=\"aes-dock-email-messages\" class=\"aes-list\">").partial("/te/pets-client-email/2.4.0/public/partialsClient/emailList.template",ctx,null).write("</div><footer id=\"aes-dock-email-footer\">").partial("/te/pets-client-email/2.4.0/public/partialsClient/emailFooter.template",ctx,null).write("</footer></div>");}return body_0;})();; return { path: '/te/pets-client-email/2.4.0/public/partialsClient/email.template' };
});
require(['pets-client-email/2.4.0/public/partialsClient/email.compiled'],function(){});

define("pets-client-email/2.4.0/public/javascript/email", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-email/2.4.0/public/javascript/emailconfig","pets-client-email/2.4.0/public/javascript/emailapi","pets-client-email/2.4.0/public/javascript/emailcache","pets-client-email/2.4.0/public/javascript/emailtracker","pets-client-email/2.4.0/public/javascript/thirdparty/sjcl","pets-client-core/2.6.0/public/javascript/userinfo"],function(a,b,c,d,e,f,g,h,i){function j(){function b(a){c.trace("PETs-Email::Email::getEmailKeyFromServer::serverResponse: Success"),c.debug("PETs-Email::Email::getEmailKeyFromServer::serverResponse: Success"),k(a)}function e(){c.trace("PETs-Email::Email::getEmailKeyFromServer::failureResponse: failure"),c.debug("PETs-Email::Email::getEmailKeyFromServer::failureResponse: failure"),n(!1,d.noCacheActionType,d.refreshInterval,!1)}var f=l(d.EmailServiceURI.KEY);a.ajax({url:f,type:"GET",contentType:"application/json",success:b,failure:e})}function k(a){var b=a.key;f.getFolderSummary(function(a){var g,i=a.foldersummary;f.getUpdatedTime(function(a){c.trace("PETs-Email::Email::retrieveUpdatedTimeFromCache: updatedDateTime="+a.updatedtime);var f=a.cacheupdatedtime;try{var j=h.decrypt(b,i);g=JSON.parse(j),g.folderSummary.updateDateTime=f,D=g.folderSummary,E=g.folderSummary.unreadMessageCount,e.postMessages(g.folderSummary)}catch(k){c.trace("PETs-Email::Email::decryptEmailListFromCache error thrown decrypting"+k),n(!1,d.noCacheActionType,d.refreshInterval,!1)}})})}function l(a){var b=a,c=(new Date).getTime();return a=a.replace(/([?&])_cb[^&]*/,"$1_cb="+c),a===b&&(a+=(/\?/.test(b)?"&":"?")+"_cb="+c),a}function m(){c.trace("PETs-Email::Email::getEmailListFromCache get inbox folder summary data from cache"),f.getFolderSummary(function(a){b.isUndefinedOrNull(a)?n(!1,d.noCacheActionType,d.refreshInterval,!1):j()})}function n(b,f,i,j,k,m){function n(a){var b=JSON.stringify(a);B=!1,e.postMessages(a.folderSummary);var c=a.folderSummary.key,d=h.encrypt(c,b);if(q(d,a.folderSummary.updateDateTime),u(a.folderSummary.unreadMessageCount),k){e.postWorking(!1,m);var f={"Previous Unread":E,"New Unread":a.folderSummary.unreadMessageCount},i="Previous Unread: "+E+" | New Unread: "+a.folderSummary.unreadMessageCount;g.gaTrackEvent(g.getAnalyticsEvents().Refresh,f),g.logToEmailCDS(g.getBILoggingEvents().Refresh,i)}E=a.folderSummary.unreadMessageCount,D=a.folderSummary}function r(a){if(B=!1,null===a||0===a.length)return void p(k,m);try{var b=JSON.parse(a.responseText);if(1!==b.result.error.code)return void p(k,m);o()}catch(c){p(k,m)}}if(c.trace("PETs-Email::Email::getEmailListFromServer get inbox folder summary data from server"),b=b||!1,b||!B){k&&e.postWorking(!0);var s=d.EmailServiceURI.INBOX+"?numMessages="+d.numEmailMessages+"&action="+f+"&nextRefresh="+i;s=l(s),B=!0,a.ajax({url:s,type:"GET",contentType:"application/json",success:n,error:r})}}function o(){var a,b;F=!0,a=d.errorMessages.UnprovisionedError.code,b=d.errorMessages.UnprovisionedError.type,c.trace("PETs-Email::Email::showUnProvisionedAccountErrorMessage: error message="+b+" error code="+a),e.postError(a,b)}function p(a,b){var f,g;f=d.errorMessages.ConnectionError.code,g=d.errorMessages.ConnectionError.type,c.trace("PETs-Email::Email::showErrorMessage: error message="+g+" error code="+f),e.postError(f,g),a&&e.postWorking(!1,b)}function q(a,b){c.trace("PETs-Email::Email::saveFolderSummaryInCache: save email data in cache"),f.setFolderSummary({foldersummary:a}),s(b)}function r(){return c.trace("PETs-Email::Email::getFolderSummaryFromLocal"),D}function s(a){c.trace("PETs-Email::Email::saveUpdatedTimeInCache: updatedDateTime="+a),f.setUpdatedTime({cacheupdatedtime:a}),C=a}function t(a){c.trace("PETs-Email::Email::saveEmailAddressInCache: emailAddress="+a),f.setUserEmailAddress({useremailaddress:a})}function u(a){c.trace("PETs-Email::Email::saveUnreadMessageCountInCache: unreadCount="+a),f.setUnreadMessageCount({unreadcount:a})}function v(){return c.trace("PETs-Email::Email::getUnreadMessageCountFromLocal"),E}function w(){return c.trace("PETs-Email::Email::getFolderSummaryCacheUpdatedTime"),C}function x(a){c.trace("PETs-Email::Email::setFolderSummaryCacheUpdatedTime: updatedTime="+a),C=a}function y(){return G}function z(){return F}function A(a){var c=v();b.isUndefinedOrNull(c)?f.getUnreadMessageCount(function(d){c=b.isUndefinedOrNull(d,"unreadcount")?0:d.unreadcount,b.doCallback(a,this,c)}):b.doCallback(a,this,c)}c.trace("PETS-Client-Email::Email::ctor");var B=!1,C=null,D=null,E=null,F=!1,G=i.getPetsId();return{getEmailListFromServer:n,getEmailListFromCache:m,saveUpdatedTimeInCache:s,getFolderSummaryCacheUpdatedTime:w,setFolderSummaryCacheUpdatedTime:x,getFolderSummaryFromLocal:r,getUnreadMessageCountFromLocal:v,saveEmailAddressInCache:t,getPetsId:y,isUnProvisionedError:z,getUnreadMessageCount:A}});

define("pets-client-email/2.4.0/public/javascript/emailutil", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-email/2.4.0/public/javascript/emailconfig","pets-client-email/2.4.0/public/javascript/emailcache","pets-client-email/2.4.0/public/javascript/emailapi","pets-client-email/2.4.0/public/javascript/email"],function(a,b){function c(a){var b=a.replace(/[<]/g,"&lt;");return b=b.replace(/[>]/g,"&gt;"),b=b.replace(/[\"]/g,"&quot;"),b=b.replace(/[\']/g,"&#39;")}function d(a){if(null===a)return"";var c=new Date(a),d=f();return b.formatDate(new Date,"M/d/yy")===b.formatDate(c,"M/d/yy")?b.formatDate(c,"h:mm tt"):d===b.formatDate(c,"M/d/yy")?"Yesterday":b.formatDate(c,"M/d/yy")}function e(a){if(null===a)return"";var c=new Date(a),d=f();return b.formatDate(new Date,"M/d/yy")===b.formatDate(c,"M/d/yy")?b.formatDate(c,"h:mm tt"):d===b.formatDate(c,"M/d/yy")?"Yesterday at "+b.formatDate(c,"h:mm tt"):b.formatDate(c,"MMM d")+" at "+b.formatDate(c,"h:mm tt")}function f(){var a=new Date,c=864e5,d=a-c,e=new Date(d),f=b.formatDate(e,"M/d/yy");return f}function g(a,b){if(a.toUpperCase().indexOf(b.toUpperCase())>-1)return"me";var d=a.indexOf(" <");return d>-1&&(a=a.substr(0,d)),d=a.indexOf("@"),d>-1&&(a=a.substr(0,d)),c(a)}return{formatTimestamp:d,formatSenderName:g,formatTimeStampForAnalytics:e}});

define("pets-client-email/2.4.0/public/javascript/emailpreferences", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-email/2.4.0/public/javascript/emailconfig","pets-client-email/2.4.0/public/javascript/emailcache","pets-client-email/2.4.0/public/javascript/emailapi","pets-client-email/2.4.0/public/javascript/email"],function(a,b,c,d,e,f,g){function h(){c.trace("PETs-Client-Email::EmailPreferences::loadPreferences"),e.getUserEmailAddress(function(a){c.trace("PETS-Client-Email::EmailPreferences::checkIfSameUser");var d=null;b.isUndefinedOrNull(a)||b.isUndefinedOrNull(a.useremailaddress)||(d=a.useremailaddress,c.debug("emailAddressFromCache: "+a.useremailaddress+" email.getPetsId(): "+g.getPetsId())),d===g.getPetsId()?n():(t=k(),m(),f.postPreferences(u))})}function i(){function b(a){function b(){var a=this;if(0===a.domains.length)return!1;var b=g(a,r);return b?!0:!1}var c=u;if(c||(h(),c=u,f.postPreferences(c)),b.apply(a)){var d=g(a,r);d&&d!=c[q]&&(u[q]=d,f.postPreferences(u),m(q,d))}else c[q]!=s&&j(r,c[q])}function e(){}function g(a,b){var c;try{for(var d=0;d<a.domains.length;d++)if("undefined"!==a.domains[d].domainName&&"edu.apollogrp.pets.email.preferences"===a.domains[d].domainName)for(var e=0;e<a.domains[d].preference.length;e++)if("undefined"!==a.domains[d].preference[e].preferenceName&&a.domains[d].preference[e].preferenceName===b){c=a.domains[d].preference[e].preferenceValue;break}}catch(f){}return c}c.trace("PETs-Client-Email::EmailPreferences::retrievePrefFromDbStorage");var i=d.preferencesURI.GET_PREF;a.ajax({url:i,type:"GET",cache:!1,contentType:"application/json",success:b,error:e})}function j(b,e){c.trace("PETs-Client-Email::EmailPreferences::savePrefToDbStorage");var f=d.preferencesURI.SET_PREF,g='{"domainName":"edu.apollogrp.pets.email.preferences", "preferenceName":"'+b+'", "preferenceValue":"'+e+'"}';a.ajax({url:f,type:"POST",contentType:"application/json",data:g,success:Function.empty,error:Function.empty})}function k(){return c.trace("PETs-Client-Email::EmailPreferences::getDefaultPreferences"),{linesPerMessage:s}}function l(a,b){c.trace("PETs-Client-Email::EmailPreferences::updatePreference"),"string"==typeof b&&(b=parseInt(b,10)),a==q&&(m(a,b),j(r,b),f.postPreferences(u))}function m(a,d){c.trace("PETs-Client-Email::EmailPreferences::savePrefInCache");var f=u;b.isUndefinedOrNull(a)||b.isUndefinedOrNull(d)?(b.isUndefinedOrNull(f)&&(f={}),f[q]=t[r],u=f,e.setPreferences(f)):a==q&&(f[q]=d,e.setPreferences(f)),u=f}function n(){c.trace("PETs-Client-Email::EmailPreferences::retrievePrefFromCache"),e.getPreferences(function(a){b.isUndefinedOrNull(a)?(t=k(),m()):a[q]&&(b.isUndefinedOrNull(u)&&(u={}),u[q]=a[q]),f.postPreferences(u)})}function o(){return q}function p(){return u[q]}var q="preferencesLinesPerMessage",r="linesPerMessage",s=2,t=null,u=null;return{retrievePrefFromDbStorage:i,savePrefToDbStorage:j,loadPreferences:h,updatePreference:l,getLinesPerMessageAttrName:o,getLinesPerMessageFromCache:p}});

define("pets-client-email/2.4.0/public/javascript/emailpolling", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-email/2.4.0/public/javascript/emailconfig","pets-client-email/2.4.0/public/javascript/emailcache","pets-client-email/2.4.0/public/javascript/email","pets-client-email/2.4.0/public/javascript/emailpreferences"],function(a,b,c,d,e,f,g){function h(a){w=a}function i(){c.trace("PETs-Client-Email::EmailPolling::pollServer checking cache"),r()}function j(a){v=setInterval(i,a)}function k(){e.getUpdatedTime(function(a){b.isUndefinedOrNull(a)?(h(null),s(!0)):b.isUndefinedOrNull(a.cacheupdatedtime)?(h(null),s(!0)):(c.debug("UpdatedTimeFromCache: "+a.cacheupdatedtime),h(a.cacheupdatedtime),s(!1))})}function l(){e.getUserEmailAddress(function(a){var d=null;b.isUndefinedOrNull(a)||b.isUndefinedOrNull(a.useremailaddress)||(d=a.useremailaddress,c.debug("emailAddressFromCache: "+a.useremailaddress+" email.getPetsId(): "+f.getPetsId())),d===f.getPetsId()?k():(c.debug("save emailAddress In Cache: email.getPetsId(): "+f.getPetsId()),f.saveEmailAddressInCache(f.getPetsId()),h(null),s(!0))})}function m(){c.trace("PETs-Client-Email::EmailPolling::initializePolling"),t=d.pollingInterval,u=d.minutePollingInterval,l()}function n(){var a=q(),b=p();("undefined"==typeof b||null===b)&&(b=0);var d=a-b;return d>2*t?(c.trace("PETs-Client-Email::EmailPolling::isFirstTimeFetchFolderSummary delta ="+d/1e3),!0):!1}function o(){var a=q();h(a),c.debug("set UpdateTime in Cache: "+a),f.setFolderSummaryCacheUpdatedTime(a),f.saveUpdatedTimeInCache(a)}function p(){return w}function q(){var a=new Date;return a.getTime()}function r(){var a=q(),b=p();if("undefined"==typeof b||null===b)n()?(o(),g.retrievePrefFromDbStorage(),f.getEmailListFromServer(!1,d.noCacheActionType,d.refreshInterval,!1)):(o(),f.getEmailListFromServer(!1,d.cacheOnlyActionType,d.refreshInterval,!1)),c.trace("PETs-Client-Email::EmailPolling::checkIfUpdated cacheUpdatedTime is null. getting from server"),c.debug("PETs-Client-Email::EmailPolling::checkIfUpdated cacheUpdatedTime is null. getting from server");else{if(f.isUnProvisionedError())return;var e=a-b;if(c.debug("PETs-Client-Email::EmailPolling::checkIfUpdated delta: "+e/1e3),e>t)c.trace("PETs-Client-Email::EmailPolling::checkIfUpdated checkIfUpdated cache expired: "+e/1e3),c.debug("PETs-Client-Email::EmailPolling::checkIfUpdated checkIfUpdated cache expired: "+e/1e3),n()?(o(),g.retrievePrefFromDbStorage(),f.getEmailListFromServer(!1,d.noCacheActionType,d.refreshInterval,!1)):(o(),f.getEmailListFromServer(!0,d.cacheOnlyActionType,d.refreshInterval,!0));else{var h=f.getFolderSummaryCacheUpdatedTime();null===h&&(c.trace("PETs-Client-Email::EmailPolling::checkIfUpdated get folder summary from cache, which was written by another pets email apps."),f.getEmailListFromCache())}}}function s(a){j(u),a&&r(),c.trace("PETs-Client-Email::EmailPolling::setPollingTimer setting polling interval to 1 min")}var t,u,v=0,w="";return{initializePolling:m,poll:i}});

define("pets-client-email/2.4.0/public/javascript/emailmanager", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/externalevent","pets-client-email/2.4.0/public/javascript/emailapi","pets-client-email/2.4.0/public/javascript/emailconfig","pets-client-email/2.4.0/public/javascript/email","pets-client-email/2.4.0/public/javascript/emailpolling","pets-client-email/2.4.0/public/javascript/emailtracker","pets-client-email/2.4.0/public/javascript/emailutil","pets-client-email/2.4.0/public/javascript/emailpreferences"],function(a,b,c,d,e,f,g,h,i,j,k){function l(){h.poll()}function m(a){g.getUnreadMessageCount(a)}function n(a,b){c.trace("PETs-Client-Email::EmailManager::onManualRefresh"),g.getEmailListFromServer(!1,f.noCacheActionType,f.noRefreshInterval,!1,!0,b.setWorkingStatusFocus)}function o(){c.trace("PETs-Client-Email::EmailManager::onLoadPreferences"),k.loadPreferences()}function p(){c.trace("PETs-Client-Email::EmailManager::onLoadUnreadMessageCount"),g.getUnreadMessageCount(function(a){e.postUpdateUnreadMessageCount(a)})}function q(){c.trace("PETs-Client-Email::EmailManager::startPolling"),h.initializePolling()}function r(a,b){c.trace("PETs-Client-Email::EmailManager::onUpdatePreferences"),s(a,{action:t.PreferencesChange,index:b}),k.updatePreference(b.name,b.value)}function s(a,b){var d="",e="",f="",h="",l=i.getAnalyticsEvents(),m=i.getBILoggingEvents();switch(b.action){case t.InboxClick:f=m.GoToInbox,h="Unread Count: "+g.getUnreadMessageCountFromLocal(),d=l.GoToInbox,e={"Unread Count":g.getUnreadMessageCountFromLocal()};break;case t.MessageClick:var n=g.getFolderSummaryFromLocal();f=m.EmailOpen,h="Email Time: "+j.formatTimeStampForAnalytics(n.emailMessageInfo[b.index].sent)+" | Title: "+encodeURIComponent(null===n.emailMessageInfo[b.index].subject?"(No Subject)":n.emailMessageInfo[b.index].subject)+" | From: "+j.formatSenderName(n.emailMessageInfo[b.index].sender,n.address),d=l.EmailOpen,e={"Email Time":j.formatTimeStampForAnalytics(n.emailMessageInfo[b.index].sent)};break;case t.PreferencesIconOpen:f=m.PreferencesOpen,h="Action: open",d=l.PreferencesOpen,e={Action:"open"};break;case t.PreferencesIconClose:f=m.PreferencesClose,h="Action: close",d=l.PreferencesClose,e={Action:"close"};break;case t.PreferencesChange:f=m.PreferencesChange,d=l.PreferencesChange,b.index.name==k.getLinesPerMessageAttrName()&&(h="Changed: lines | Previous: "+k.getLinesPerMessageFromCache()+" | New: "+b.index.value,e={Changed:"lines",Previous:k.getLinesPerMessageFromCache(),New:b.index.value});break;default:c.error("PETs-Email::EmailManager::onClickAction ","no matching action found")}i.gaTrackEvent(d,e),i.logToEmailCDS(f,h)}c.trace("PETS-Client-Email::EmailManager::ctor");var t=f.clickActions;return e.subscribeRefresh(n),e.subscribePollingControl(q),e.subscribeClickEvent(s),e.subscribeLoadPreferences(o),e.subscribeUpdatePreferences(r),e.subscribeLoadUnreadMessageCount(p),{poll:l,getUnreadMessageCount:m}});

define("pets-client-email/2.4.0/public/javascript/emailcontroller", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/petsconfig!modulemanifest","pets-client-core/2.6.0/public/javascript/externalevent","pets-client-core/2.6.0/public/javascript/controllerbase","pets-client-email/2.4.0/public/javascript/emailapi","pets-client-email/2.4.0/public/javascript/emailmanager","pets-client-email/2.4.0/public/javascript/emailconfig"],function(a,b,c,d,e,f,g,h,i){function j(){function a(a,b){s.updateViews({renderOperation:q.UpdateUnreadMessageCount,unreadMessageCount:b.unreadMessageCount}),s.updateViews({renderOperation:q.RenderMain,emailInfo:b}),r=!1}function d(a,b){s.updateViews({renderOperation:q.UpdateUnreadMessageCount,unreadMessageCount:b}),r=!1}function e(a,d){c.error("PETS-Client-Email::EmailController::onError",b.formatString("code={0}, message={1}",d.code,d.message)),r=!0,d.code==i.errorMessages.UnprovisionedError.code?s.updateViews(i.displayAutoProvisioningUrl===!1?{renderOperation:q.Error,error:{type:i.errorMessages.UnprovisionedError.type,message:i.errorMessages.UnprovisionedError.message,suggestion:null}}:{renderOperation:q.Error,error:{type:i.errorMessages.UnprovisionedError.type,message:i.errorMessages.UnprovisionedError.messageForProvisionUrl,suggestion:i.errorMessages.UnprovisionedError.suggestion}}):d.code==i.errorMessages.ConnectionError.code&&s.updateViews({renderOperation:q.Error,error:{type:i.errorMessages.ConnectionError.type,message:i.errorMessages.ConnectionError.message,suggestion:i.errorMessages.ConnectionError.suggestion}})}function f(a,b){c.trace("PETs-Client-Email::EmailController::displayLoader"),s.updateViews({renderOperation:q.DisplayWorkingStatus,status:b.isWorking,setFocus:b.setFocus})}function j(a,b){c.trace("PETs-Client-Email::EmailController::onPreferences"),s.updateViews({renderOperation:q.UpdatePreferences,preferences:b})}function k(a){h.poll(),b.doCallback(a)}function l(a){a||(a=!1),g.postRefresh(a)}function m(a,b){g.postClickEvent(a,b)}function n(a,b){var c={};c.name=a,c.value=b,g.postUpdatePreferences(c)}function o(){return r}var p=i.clickActions,q={RenderMain:0,Error:1,DisplayWorkingStatus:2,UpdatePreferences:3,UpdateUnreadMessageCount:4},r=!1,s=this;g.subscribeMessages(a),g.subscribeError(e),g.subscribeWorking(f),g.subscribePreferences(j),g.subscribeUpdateUnreadMessageCount(d),g.postLoadPreferences(!0),g.postLoadUnreadMessageCount(),g.postPollingControl(!0),this.ensureContentLoaded=k,this.manualRefresh=l,this.clickActions=p,this.renderOperations=q,this.onClickAction=m,this.onPreferencesChange=n,this.isServerError=o}return c.trace("PETS-Client-Email::EmailController::ctor"),f.extend(j)});

define("pets-client-email/2.4.0/public/javascript/emailwidgettemplates", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-email/2.4.0/public/javascript/thirdparty/jquery-dotdotdot","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/templatemanager","pets-client-email/2.4.0/public/javascript/emailconfig","pets-client-email/2.4.0/public/javascript/emailcontroller","pets-client-email/2.4.0/public/partialsClient/email.compiled","pets-client-email/2.4.0/public/partialsClient/emailList.compiled","pets-client-email/2.4.0/public/partialsClient/emailFooter.compiled","pets-client-email/2.4.0/public/partialsClient/emailCalc.compiled"],function(a,b,c,d,e,f,g){function h(b){b.on("click",v.notification.linkSelector,function(a){a.preventDefault(),p(a.target.href,!0)}),b.on("click",v.manualRefresh.selector,function(){g.manualRefresh(!0)}),b.on("click",v.inbox.selector,function(){p(o()),g.onClickAction(g.clickActions.InboxClick)}),b.on("click",v.preferences.selector,function(){a(v.footer.selector).hasClass(v.footer.preferencesSelectedClassName)?r():q()}),b.on("change",v.footer.preferencesNumLines,function(){var b=a(v.footer.preferencesNumLines).attr(v.footer.preferencesNumLinesAttrName),c=a(v.footer.preferencesNumLines).val();g.onPreferencesChange(b,c),i(c,!0)}),b.on("keyup",v.footer.preferencesNumLines,function(b){27==b.keyCode&&(b.preventDefault(),r(),a(v.preferences.selector).focus())}),b.on("keydown",v.footer.preferencesNumLines,function(b){9==b.which&&(b.preventDefault(),r(),a(v.preferences.selector).focus())}),b.on("click",v.message.subjectSelector,function(a){var b=a.target.id.substring(a.target.id.lastIndexOf("-")+1);a.preventDefault(),p(a.target.href),g.onClickAction(g.clickActions.MessageClick,b)}),b.on("click",v.errorMessage.selector,function(){var b=a(this),c=b.attr(v.errorMessage.typeAttribute),d=b.html();c==f.errorMessages.ConnectionError.type?g.manualRefresh():c==f.errorMessages.UnprovisionedError.type&&d&&p(f.autoProvisioningUrl)}),e.appendToFromTemplate("body",v.scrollbar.templateName,null,function(){var b=a(v.scrollbar.calcSelector),c=b.find(v.scrollbar.calcInnerSelector);u=b.outerWidth()-c.outerWidth(),b.remove()})}function i(b,c){a(v.footer.preferencesNumLines).attr(v.footer.preferencesNumLinesAttrName,v.footer.preferencesNumLinesAttrText);var d=a(v.footer.preferencesNumLinesOptions);d.each(function(){return a(this).val()==b?void a(this).attr("selected",!0):void 0}),c&&a(v.footer.preferencesNumLines).focus()}function j(a,b,c){var f=a.get$ClientAreaRootElement(),g=e.replaceContentFromTemplate;t=b.folderSummary.address,g(f.find(v.notification.selector),v.notification.templateName,b),g(f.find(v.message.listSelector),v.message.templateName,b,function(){k(a,b),g(f.find(v.footer.selector),v.footer.templateName,b,function(){s(),d.doCallback(c)})})}function k(b,c,e){var f=b.getClientAreaSize().width,g=u+5+"px";if(0!==f){var h,i=c.options.lineCount,j=a(v.message.messageSelector),k=b.get$ClientAreaRootElement(),l=k.find(v.message.listSelector);l.find(v.message.listInnerSelector).width(l.width());for(var m=0;m<j.length;m++){var o=a(j[m]);o.css("paddingRight",g),0===m&&(h=n(j.first(),i)),o.dotdotdot({height:h,watch:!0,wrap:"letter"})}d.doCallback(e)}}function l(b,c){var d=a(v.manualRefresh.selector);d.toggleClass(v.manualRefresh.defaultClass,!b),d.toggleClass(v.manualRefresh.loadingClass,b),c&&d.focus()}function m(){return t}function n(a,b){var c=a.find(v.message.subjectSelector),d=a.find(v.message.bodySelector),e=c.text(),f=d.text(),g="M"+new Array(parseInt(b,10)).join("<br/>M");try{c.html(g),d.html("");var h=a.height();c.html(""),d.html(g);var i=a.height(),j=h>i?h:i;return j}finally{c.text(e),d.text(f)}}function o(){return d.formatString(f.inboxUrl,f.domainName)}function p(a,b){var c;c=b?window.open(a,f.emailNotificationWindowName,f.emailNotificationWindowOptions):window.open(a,f.emailPopupWindowName,f.emailPopupWindowOptions),c&&c.focus()}function q(){a(v.footer.selector).toggleClass(v.footer.preferencesSelectedClassName),s(),i(a(v.preferences.selector).attr(v.footer.preferencesNumLinesAttribute),!0),g.onClickAction(g.clickActions.PreferencesIconOpen)}function r(){a(v.footer.selector).toggleClass(v.footer.preferencesSelectedClassName),s(),g.onClickAction(g.clickActions.PreferencesIconClose)}function s(){a(v.preferences.selector).attr("aria-expanded",a(v.footer.selector).hasClass(v.footer.preferencesSelectedClassName))}b.init(a);var t,u,v={main:{templateName:"pets-client-email/2.4.0/public/partialsClient/email.template"},headerControl:{id:"aes-email-inbox-link-control"},notification:{templateName:"pets-client-email/2.4.0/public/partialsClient/emailNotification.template",selector:"#aes-email-notification",linkSelector:"#aes-email-notification-link"},manualRefresh:{selector:"#aes-dock-email-refresh",defaultClass:"aes-refresh",loadingClass:"aes-loading"},preferences:{selector:"#aes-dock-email-preferences"},inbox:{selector:"#aes-dock-email-see-all"},message:{templateName:"pets-client-email/2.4.0/public/partialsClient/emailList.template",listSelector:"#aes-dock-email-messages",listInnerSelector:".aes-list-inner",messageSelector:".aes-email-message",subjectSelector:"a[id^='aes-dock-email-subject-']",bodySelector:"p[id^='aes-dock-email-body-']",countSelector:".aes-message-count"},footer:{templateName:"pets-client-email/2.4.0/public/partialsClient/emailFooter.template",selector:"#aes-dock-email-footer",preferencesSelectedClassName:"aes-selected",preferencesNumLines:"#aes-dock-email-preferences-lines",preferencesNumLinesOptions:"#aes-dock-email-preferences-lines option",preferencesNumLinesAttrName:"data-prefLinesPerMessage",preferencesNumLinesAttrText:"preferencesLinesPerMessage",preferencesNumLinesAttribute:"data-num-lines"},scrollbar:{templateName:"pets-client-email/2.4.0/public/partialsClient/emailCalc.template",calcSelector:".aes-email-calc",calcInnerSelector:".aes-email-calc-inner"},errorMessage:{selector:"#aes-dock-email-error",typeAttribute:"data-type"}};return{addOverflowEllipsis:k,displayRefreshStatus:l,renderMain:j,setupHandlers:h,setPreferences:i,getEmailAddress:m,Templates:v}});

define("pets-client-email/2.4.0/public/javascript/emailheadercontrol", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/lightweightwindowbase","pets-client-core/2.6.0/public/javascript/templatemanager","pets-client-email/2.4.0/public/javascript/emailconfig","pets-client-email/2.4.0/public/javascript/emailcontroller","pets-client-email/2.4.0/public/javascript/emailwidgettemplates","pets-client-email/2.4.0/public/partialsClient/emailheadercontrol.compiled"],function(a,b,c,d,e,f,g){function h(){function a(a,b){var c;c=b?window.open(a,f.emailNotificationWindowName,f.emailNotificationWindowOptions):window.open(a,f.emailPopupWindowName,f.emailPopupWindowOptions),c&&c.focus()}function c(){return d.get$ClientAreaRootElement().find(e.inbox.selector)}var d=this,e={inbox:{templateName:"pets-client-email/2.4.0/public/partialsClient/emailheadercontrol.template",selector:"#aes-email-inbox-link"}};this.windowCreated(function(){d.get$ClientAreaRootElement().on("click",e.inbox.selector,function(){a(b.formatString(f.inboxUrl,f.domainName)),g.onClickAction(g.clickActions.InboxClick)})}),d.get$focusElement=c}return{create:function(a,b){b.template="pets-client-email/2.4.0/public/partialsClient/emailheadercontrol.template";var c=d.extend(h,arguments,a,b);return c.load(),c}}});

define("pets-client-email/2.4.0/public/javascript/emailwidgetfactory.bundle", ["ncf-thirdparty/jquery-1.7.1/public/javascript/jquery","pets-client-core/2.6.0/public/javascript/utility","pets-client-core/2.6.0/public/javascript/logger","pets-client-core/2.6.0/public/javascript/widgetbase","pets-client-core/2.6.0/public/javascript/windowmanager","pets-client-email/2.4.0/public/javascript/emailutil","pets-client-email/2.4.0/public/javascript/emailheadercontrol","pets-client-email/2.4.0/public/javascript/emailwidgettemplates","pets-client-email/2.4.0/public/javascript/emailcontroller"],function(a,b,c,d,e,f,g,h,i){function j(a,d){function g(){b.isUndefinedOrNull(r)&&(r=t.getParentWindow()),b.isUndefinedOrNull(q)&&(q=t.get$ClientAreaRootElement())}function j(){return t.getControl(h.Templates.headerControl.id).get$focusElement()}function k(){g(),r.getIsVisible()&&i.ensureContentLoaded(function(){h.addOverflowEllipsis(t,u,l)})}function l(){var a,c,e,f,i=h.Templates;g(),a=q.find(i.notification.selector).outerHeight(),c=q.find(i.message.listSelector),e=q.find(i.footer.selector).outerHeight(),f=d.resizeToParentClientArea&&!b.isUndefinedOrNull(r)?r.getClientAreaSize().height:t.getClientAreaSize().height,c.height(f-a-e)}function m(){l(),s||(s=setTimeout(function(){s=null,h.addOverflowEllipsis(t,u)},75))}function n(){c.trace("PETs-Client-Email::emailWidget::init"),t.base.init(),h.setupHandlers(t.get$ClientAreaRootElement(),i),e.getPetsDock().registerTitlebarControl(a,t.getControl(h.Templates.headerControl.id)),t.postLoaded()}function o(a){switch(c.trace("PETs-Client-Email::emailWidget::render"),c.debug("PETs-Client-Email::emailWidget::render"),a.renderOperation){case i.renderOperations.RenderMain:u.folderSummary=a.emailInfo,u.error=null,h.renderMain(t,u,l),h.setPreferences(u.options.lineCount);break;case i.renderOperations.DisplayWorkingStatus:h.displayRefreshStatus(a.status,a.setFocus);break;case i.renderOperations.Error:u.error={type:a.error.type,message:a.error.message,suggestion:a.error.suggestion},h.renderMain(t,u,l);break;case i.renderOperations.UpdatePreferences:u.options.lineCount=a.preferences[h.Templates.footer.preferencesNumLinesAttrText],b.isUndefinedOrNull(u.folderSummary.address)||(h.renderMain(t,u,l),h.setPreferences(u.options.lineCount,!0));break;case i.renderOperations.UpdateUnreadMessageCount:p(a.unreadMessageCount)}}function p(a){t.postMessageIndication({text:a>0?a>99?"99+":a:null})}var q,r,s,t=this,u={formatTimestamp:function(a,b,c,d){return a.write(f.formatTimestamp(d.value))},formatTimestampToISO:function(a,c,d,e){return a.write(b.getDateAsIso8601(new Date(e.value)))},formatSenderName:function(a,b,c,d){return a.write(f.formatSenderName(d.sender,b.get("folderSummary").address))},folderSummary:{address:null,messageCount:0,unreadMessageCount:0,updateDateTime:null,emailMessageInfo:[]},options:{lineCount:"4"},error:{type:null,message:null,suggestion:null}};e.getPetsBar().registerIcon(a,this,d),this.resized(m),this.shown(k),this.init=n,this.render=o,this.__get$focusInElement=j,i.registerView(a,this)}return c.trace("PETs-Client-Email::emailWidgetFactory::ctor"),{create:function(a,b){return c.trace("PETs-Client-Email::contactsWidgetFactory::create"),b.template=h.Templates.main.templateName,d.extend(j,a,b)}}});

define("pets-client-email/2.4.0/public/javascript/emailwidgetfactory", ["pets-client-email/2.4.0/public/javascript/emailwidgetfactory.bundle"], function(temp){
  return temp;
});
